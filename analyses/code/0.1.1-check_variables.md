Variable Check
================

``` r
knitr::opts_chunk$set(message = FALSE, warning = FALSE, cache = FALSE, out.width = "50%")
```

``` r
if (!require(pacman)) install.packages("pacman")
pacman::p_load(data.table, corrplot, ltm)
pacman::p_load_gh("janajarecki/themejj")
.default_font <- "Roboto Condensed"
theme_set(theme_classic())

# set working directory to THIS file location
# setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# Load preprocessed data
source("0.1-preprocess.R")
```

    ## 
    ## --------------------------- Exclusion Report
    ##      attention dataquality progress Count
    ## [1,]                       progress 382  
    ## [2,] attention                       61  
    ## [3,] attention dataquality           21  
    ## [4,]           dataquality            9  
    ## [5,] attention             progress   4

``` r
d <- fread("../../data/processed/data.csv")

corrplot.mixed <- function(data) {
  colnames(data) <- gsub("_", "\n", colnames(data))
  a <- cronbach.alpha(data)$alpha 
  corrplot::corrplot.mixed(cor(data), order="hclust", tl.col="black", title= paste("Cronbach's alpha = ", round(a, 2)), mar=c(0,0,1,0))
}

hist.raw <- function(var, true = NA, bw) {
  pp <- ggplot(d, aes_string(x = var)) +
  geom_histogram(binwidth = bw, color = "black", fill = "grey90") +
  scale_y_continuous(expand = c(0,0))
  if (!is.na(true)) pp <- pp + geom_vline(aes(xintercept = true), color = "red", size = 2)
  plot(pp)
}
```

# Sample

A total of 1234 participants participated, 477 were excluded, 386
because they did not finish the survey; leaving ***N =* 757**.

# Independent Variables

## Risk Attitudes

How much risk do you take regarding … ?

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^risk")])
```

<img src="0.1.1-check_variables_files/figure-gfm/risk-1.png" width="50%" />

## Risk Knowledge and other Knowledge

Knowledge, Total Deaths, Total Infected

``` r
corrplot.mixed(data = d[, lapply(.SD, as.double), .SDcols = patterns("^know")][, -c("know_symptoms", "know_symptoms_perc")])
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -1.png" width="50%" />

``` r
hist.raw("raw_know_death_total", 2000, 300)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -2.png" width="50%" />

``` r
hist.raw("raw_know_infected_all_ab", 35000, 2000)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -3.png" width="50%" />

``` r
hist.raw("know_econ", NA, 25)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -4.png" width="50%" />

``` r
hist.raw("raw_know_age", 75, 5)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -5.png" width="50%" />

``` r
hist.raw("know_symptoms_perc", NA, .05)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -6.png" width="50%" />

``` r
hist.raw("perc_infected_next7", NA, 5)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -7.png" width="50%" />

``` r
hist.raw("perc_infected_last7", NA, 5)
```

<img src="0.1.1-check_variables_files/figure-gfm/know, -8.png" width="50%" />

## Identification with all Humanity

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^iwah_community$|iwah_swiss$|iwah_world$")])
```

<img src="0.1.1-check_variables_files/figure-gfm/iwah-1.png" width="50%" />

## Safety-related behavior

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^safety")])
```

<img src="0.1.1-check_variables_files/figure-gfm/safety-1.png" width="50%" />

``` r
hist.raw("safety_mask", bw = .1)
```

<img src="0.1.1-check_variables_files/figure-gfm/safety-2.png" width="50%" />

``` r
hist.raw("safety_distance", bw = .1)
```

<img src="0.1.1-check_variables_files/figure-gfm/safety-3.png" width="50%" />

``` r
hist.raw("safety_hygene", bw = .1)
```

<img src="0.1.1-check_variables_files/figure-gfm/safety-4.png" width="50%" />

## belief local/global

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^belief_l|^belief_g")])
```

<img src="0.1.1-check_variables_files/figure-gfm/belief, -1.png" width="50%" />

## belief local/global and identification with all humanity

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^belief_l|^belief_g|iwah_s|iwah_w")])
```

<img src="0.1.1-check_variables_files/figure-gfm/belief-iwah-1.png" width="50%" />

# Honesty Humility

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^honhum")])
```

<img src="0.1.1-check_variables_files/figure-gfm/honhum-1.png" width="50%" />

# Honesty Humility

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^honhum_score|^risk")])
```

<img src="0.1.1-check_variables_files/figure-gfm/honhum-risk-1.png" width="50%" />

# Tech

``` r
corrplot.mixed(data = d[has_smartphone == 1, .SD, .SDcols = patterns("^tech")][, -"tech_score"])
```

<img src="0.1.1-check_variables_files/figure-gfm/tech-1.png" width="50%" />

## Tech - Compliance

Tech Interest only if has\_smartphone == true

``` r
corrplot.mixed(data = d[has_smartphone == 1, .SD, .SDcols = patterns("^tech")][, -"tech"])
```

<img src="0.1.1-check_variables_files/figure-gfm/tech-compliance-1.png" width="50%" />

# Policy

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^attitudes")])
```

<img src="0.1.1-check_variables_files/figure-gfm/policy-1.png" width="50%" />

# Comprehension of the App’s working

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^comprehe")])
```

<img src="0.1.1-check_variables_files/figure-gfm/understanding-1.png" width="50%" />

# Safety-related behavior

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("safety|^risk_domain_health")])
```

<img src="0.1.1-check_variables_files/figure-gfm/hygene-1.png" width="50%" />

# Non-response checks

``` r
  knitr::kable(
    d[, .(income = table(income_num_1_text == ""),
        wealth = table(wealth_num_1_text == ""))]
  )
```

| income.V1 | income.N | wealth.V1 | wealth.N |
| :-------- | -------: | :-------- | -------: |
| FALSE     |      531 | FALSE     |      442 |
| TRUE      |      226 | TRUE      |      315 |

# Dependent Variables

## Acceptance

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^acc_")])
```

<img src="0.1.1-check_variables_files/figure-gfm/acc-1.png" width="50%" />

## Compliance

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^com_")])
```

<img src="0.1.1-check_variables_files/figure-gfm/com-1.png" width="50%" />

## Raw correlations between IVs and DVs

Tech - Acceptance

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^tech$|accept_index")])
```

<img src="0.1.1-check_variables_files/figure-gfm/tech-acceptance-1.png" width="50%" />

Compliance - Acceptance

``` r
corrplot.mixed(data = d[, .SD, .SDcols = patterns("^comply_index|accept_index")])
```

<img src="0.1.1-check_variables_files/figure-gfm/com-acceptance-1.png" width="50%" />
